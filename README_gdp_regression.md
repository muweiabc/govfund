# GDP与政府基金数量回归分析

本项目包含两个主要脚本，用于分析政府基金数据并进行GDP回归分析。

## 文件说明

### 1. analyze_govfund.py
- **功能**: 读取`govfund_filtered.xlsx`文件，按年份和省份统计新成立的基金
- **输出**: 
  - 控制台统计结果
  - 可视化图表
  - `govfund_analysis_results.xlsx`文件（包含多个sheet）

### 2. gdp_regression.py
- **功能**: 从GDP数据中读取各省对应年份的人均GDP，对基金数量进行回归分析
- **输入**: 
  - `gdp.xlsx` (包含人均地区生产总值数据)
  - `govfund_analysis_results.xlsx` (基金分析结果)
- **输出**: 
  - 回归分析结果
  - 可视化图表
  - 回归统计信息

## 使用方法

### 步骤1: 安装依赖
```bash
pip install -r requirements.txt
```

### 步骤2: 运行基金分析
```bash
python analyze_govfund.py
```

### 步骤3: 运行GDP回归分析
```bash
python gdp_regression.py
```

## 数据要求

### govfund_filtered.xlsx
- 必须包含基金成立时间信息
- 必须包含注册地区/省份信息
- 建议列名包含: "成立时间", "注册地区" 等

### gdp.xlsx
- 必须包含人均地区生产总值数据
- 必须包含年份和省份信息
- 建议列名包含: "人均地区生产总值/元" 等

## 输出结果

### 基金分析结果 (govfund_analysis_results.xlsx)
- **年份省份统计**: 按年份和省份的基金数量统计
- **年度统计**: 按年份的基金总数统计
- **省份统计**: 按省份的基金总数统计
- **年份省份透视表**: 年份-省份的交叉统计表

### 回归分析结果
- **R²决定系数**: 模型解释能力
- **回归系数**: GDP对基金数量的影响程度
- **统计显著性**: F检验和t检验结果
- **可视化图表**: 散点图、残差图、分布图等

## 注意事项

1. 确保Excel文件格式正确，列名清晰
2. 数据中的年份和省份信息需要保持一致
3. 如果遇到中文显示问题，请确保系统支持中文字体
4. 建议在运行前检查数据质量，处理缺失值和异常值

## 错误排查指南

### 常见错误及解决方案

#### 1. 文件读取错误
- **错误**: `FileNotFoundError` 或 `文件不存在`
- **解决**: 检查文件路径，确保文件在当前工作目录下
- **建议**: 使用 `test_data_reading.py` 脚本验证文件状态

#### 2. 列名不匹配错误
- **错误**: `KeyError` 或 `缺少必要的列`
- **解决**: 检查Excel文件的列名，确保包含必要的列
- **必要列**: 
  - GDP文件: 包含"人均地区生产总值"的列
  - 基金文件: "成立时间", "注册地区"

#### 3. 数据类型错误
- **错误**: `TypeError` 或日期转换失败
- **解决**: 检查日期列的数据格式，确保可以转换为日期类型
- **建议**: 手动检查Excel文件中的日期格式

#### 4. 数据合并失败
- **错误**: `合并后没有数据`
- **原因**: 
  - 年份格式不匹配（如"2020" vs "2020年"）
  - 省份名称不匹配（如"北京" vs "北京市"）
  - 数据中没有重叠的年份-省份组合
- **解决**: 统一年份和省份的格式

#### 5. 可视化错误
- **错误**: 图表显示异常或中文乱码
- **解决**: 确保系统安装了中文字体
- **建议**: 在Windows系统上使用"SimHei"或"Microsoft YaHei"字体

### 调试步骤

1. **运行测试脚本**: 首先运行 `python test_data_reading.py` 检查数据文件状态
2. **检查列名**: 确认Excel文件的列名与脚本期望的列名一致
3. **检查数据格式**: 查看数据类型和内容，确保格式正确
4. **逐步运行**: 先运行基金分析，再运行GDP回归分析
5. **查看详细日志**: 脚本会输出详细的执行过程和错误信息

### 获取帮助

如果遇到问题，请：
1. 查看控制台输出的详细错误信息
2. 检查 `traceback` 中的错误堆栈
3. 确认数据文件格式和内容
4. 参考错误排查指南中的解决方案

## 技术栈

- Python 3.7+
- pandas: 数据处理
- numpy: 数值计算
- matplotlib: 数据可视化
- scikit-learn: 机器学习算法
- openpyxl: Excel文件读写
