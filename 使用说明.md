# 政府基金与GDP回归分析 - 使用说明

## 🚀 快速开始

### 方法1: 一键运行（推荐）
```bash
python run_analysis.py
```

### 方法2: 分步运行
```bash
# 步骤1: 分析政府基金数据
python analyze_govfund.py

# 步骤2: 执行GDP回归分析 (选择其中一个)
python gdp_regression.py    # 使用scikit-learn
python regress.py          # 使用linearmodels
```

## 📋 使用前准备

1. **安装依赖包**
   ```bash
   pip install -r requirements.txt
   ```

2. **准备数据文件**
   - `govfund_filtered.xlsx` - 政府基金数据
   - `gdp.xlsx` - GDP数据
   - `2003-2023各省分行业全社会固定资产投资额.xlsx` - 固定资产投资数据
   - `2000-2023年各省份城镇化水平.xlsx` - 城镇化率数据

3. **检查数据格式**
   ```bash
   python test_data_reading.py        # 基础数据检查
   python test_regress.py             # 回归分析检查
   python test_regress_investment.py  # 投资数据检查
   ```

## 📊 数据要求

### 政府基金数据 (govfund_filtered.xlsx)
- 必须包含列: `成立时间`, `注册地区`
- 成立时间: 日期格式（如: 2020-01-01）
- 注册地区: 省份名称（如: 北京、上海、广东）

### GDP数据 (gdp.xlsx)
- 必须包含列: `人均地区生产总值/元`
- 第一列: 年份
- 第二列: 省份名称

## 🔍 故障排除

### 常见问题

1. **文件不存在**
   - 检查文件是否在当前目录
   - 确认文件名拼写正确

2. **列名不匹配**
   - 使用 `test_data_reading.py` 检查列名
   - 确保列名包含必要关键词

3. **数据合并失败**
   - 检查年份和省份格式是否一致
   - 确认数据中有重叠的年份-省份组合

4. **中文显示问题**
   - Windows系统确保安装了中文字体
   - 检查系统语言设置

### 获取帮助

- 查看控制台输出的详细错误信息
- 运行测试脚本检查数据状态
- 参考 `README_gdp_regression.md` 中的详细说明

## 📁 输出文件

- `govfund_analysis_results.xlsx` - 基金分析结果
- `gdp_fund_regression_results.xlsx` - 回归分析结果 (gdp_regression.py)
- `regression_results.pickle` - 回归分析结果 (regress.py)

## ⚠️ 注意事项

- 确保Excel文件格式正确
- 数据中的年份和省份信息需要保持一致
- 建议在运行前检查数据质量
- 如果遇到问题，先运行测试脚本诊断
